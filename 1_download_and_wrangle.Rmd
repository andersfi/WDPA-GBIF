---
title: "WDPA-GBIF"
author: "Anders G. Finstad"
date: "February 3, 2021"
output: html_document
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(rio)
```

## Data download and import


```{r download, echo=FALSE}
tmp_file <- tempfile()
tmp_dir <- tempdir()
dir.create("..//raw_data")
download_url <- "http://download.gbif.org/custom_download/jwaller/protected_areas_export.zip"
download.file(download_url,destfile="../raw_data/protected_areas_export.zip")

unzip("../raw_data/protected_areas_export.zip",
      files=c("protected_areas_export_WDPA_WDOECM_shp0_table",
                       "protected_areas_export_WDPA_WDOECM_shp1_table",
                       "protected_areas_export_WDPA_WDOECM_shp2_table"),
                       exdir = "..//raw_data",overwrite = TRUE) 
file.rename(from="../raw_data/protected_areas_export_WDPA_WDOECM_shp0_table",
           to= "../raw_data/protected_areas_export_WDPA_WDOECM_shp0_table.tsv")
file.rename(from="../raw_data/protected_areas_export_WDPA_WDOECM_shp1_table",
           to= "../raw_data/protected_areas_export_WDPA_WDOECM_shp1_table.tsv")
file.rename(from="../raw_data/protected_areas_export_WDPA_WDOECM_shp2_table",
           to= "../raw_data/protected_areas_export_WDPA_WDOECM_shp2_table.tsv")

occ1 <- import("../raw_data/protected_areas_export_WDPA_WDOECM_shp0_table.tsv")
occ2 <- import("../raw_data/protected_areas_export_WDPA_WDOECM_shp1_table.tsv")
occ3 <- import("../raw_data/protected_areas_export_WDPA_WDOECM_shp2_table.tsv")

file.remove(list.files("../raw_data",full.names = TRUE))

occ <- bind_rows(occ1,occ2,occ3)
occ_sub <- occ[1:100,]
 
```


## Data wrangling and grouping
Group data on location and taxa and year. 

```{r download, echo=FALSE}

```

